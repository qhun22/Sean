{% extends "base.html" %}
{% load static %}
{% load custom_filters %}

{% block title %}TRẠNG THÁI - QHUN22 Mobile{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/order_success.css' %}">
{% endblock %}

{% block content %}
<div class="qh-os-page">

    <h1 class="qh-page-title">TRẠNG THÁI</h1>

    <!-- Wrapper box -->
    <div class="qh-os-wrapper" id="successCard">

    <!-- Hero -->
    <div class="qh-os-hero">
        <div class="qh-os-icon">
            <svg class="qhc" viewBox="0 0 24 24"><path d="M5 13l4 4L19 7"/></svg>
        </div>
        <h2>ĐƠN HÀNG ĐÃ ĐƯỢC TẠO THÀNH CÔNG</h2>
    </div>

    <!-- Two equal boxes -->
    <div class="qh-os-grid">

        <!-- Left: Thông tin đơn hàng -->
        <div class="qh-os-info">
            <div class="qh-os-info-title">Thông tin đơn hàng</div>
            <div class="qh-os-row">
                <span class="label">Mã đơn hàng</span>
                <span class="value">{{ order.order_code }}</span>
            </div>
            <div class="qh-os-row">
                <span class="label">Phương thức</span>
                <span class="value">{{ order.get_payment_method_display }}</span>
            </div>
            <div class="qh-os-row">
                <span class="label">Trạng thái</span>
                <span class="value">{{ order.get_status_display }}</span>
            </div>
            <div class="qh-os-row">
                <span class="label">Thời gian</span>
                <span class="value">{{ order.created_at|date:"d/m/Y H:i" }}</span>
            </div>
        </div>

        <!-- Right: Buttons -->
        <div class="qh-os-actions">
            <button class="qh-os-btn primary" onclick="copyCode()">
                <i class="ri-file-copy-line"></i> Copy mã đơn
            </button>
            <a href="{% url 'store:order_tracking' %}" class="qh-os-btn">
                <i class="ri-search-line"></i> Tra cứu đơn
            </a>
            <a href="{% url 'store:home' %}" class="qh-os-btn">
                <i class="ri-home-line"></i> Trang chủ
            </a>
        </div>

    </div>

    <!-- Footer -->
    <div class="qh-os-footer">
        CẢM ƠN BẠN ĐÃ TIN TƯỞNG VÀ MUA HÀNG, CHÚC BẠN CÓ TRẢI NGHIỆM TUYỆT VỜI VỚI SẢN PHẨM NHÉ! 
    </div>

    </div><!-- /.qh-os-wrapper -->

</div>
{% endblock %}

{% block extra_js %}
{# copyCode() KHÔNG THỂ TÁCH vì chứa Django template tag {{ order.order_code }} #}
<script>
function copyCode() {
    var code = '{{ order.order_code }}';
    var btn = event.currentTarget;
    if (navigator.clipboard) {
        navigator.clipboard.writeText(code).then(function() { doCopied(btn); });
    } else {
        var ta = document.createElement('textarea');
        ta.value = code;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        doCopied(btn);
    }
}
</script>

{# JS thuần - đã tách ra file static/js/order_success.js #}
<script src="{% static 'js/order_success.js' %}"></script>
{% endblock %}
